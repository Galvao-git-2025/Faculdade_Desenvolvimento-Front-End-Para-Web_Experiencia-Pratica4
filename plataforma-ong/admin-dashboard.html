<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - Semeando o Futuro</title>
    <style>
        body { font-family: 'Arial', sans-serif; background-color: #f8f9fa; margin: 0; padding: 20px; color: #333; }
        .container { max-width: 1200px; margin: 0 auto; background: white; padding: 30px; border-radius: 8px; box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05); }
        h1, h2 { color: #28a745; border-bottom: 2px solid #eee; padding-bottom: 10px; margin-top: 30px; }
        
        /* Estilo para as Métricas */
        .metrics { display: flex; justify-content: space-between; gap: 20px; margin-bottom: 30px; }
        .metric-card { background-color: #e9ecef; padding: 20px; border-radius: 6px; text-align: center; flex: 1; }
        .metric-card h3 { margin: 0 0 5px 0; color: #6c757d; font-size: 1em; }
        .metric-card p { font-size: 2em; font-weight: bold; margin: 0; color: #28a745; }

        /* Estilo para Tabelas */
        .table-responsive { overflow-x: auto; margin-top: 20px; }
        table { width: 100%; border-collapse: collapse; margin-bottom: 20px; background-color: white; }
        th, td { padding: 12px 15px; text-align: left; border-bottom: 1px solid #dee2e6; font-size: 0.9em; }
        th { background-color: #28a745; color: white; font-weight: 600; }
        tr:nth-child(even) { background-color: #f2f2f2; }
        
        /* Estilos dos Botões */
        .action-buttons button { margin: 2px; padding: 5px 10px; border: none; border-radius: 4px; cursor: pointer; font-size: 0.8em; transition: background-color 0.3s; }
        .btn-info { background-color: #17a2b8; color: white; }
        .btn-info:hover { background-color: #117a8b; }
        .btn-danger { background-color: #dc3545; color: white; }
        .btn-danger:hover { background-color: #bd2130; }
        .btn-primary { background-color: #007bff; color: white; padding: 10px 15px; }
        .btn-success { background-color: #007bff; color: white; } 
        .btn-success:hover { background-color: #0056b3; }


        /* Estilos para badges (Projetos) */
        .badge { padding: 4px 8px; border-radius: 12px; font-size: 0.75em; font-weight: bold; }
        .status-rascunho { background-color: #adb5bd; color: white; }
        .status-novo { background-color: #ffc107; color: #333; }
        .status-andamento { background-color: #17a2b8; color: white; }
        .status-concluido { background-color: #28a745; color: white; }
        .status-cancelado { background-color: #dc3545; color: white; }
        
        /* Estilos do Modal Padrão (Projetos) */
        .modal { display: none; position: fixed; z-index: 10; left: 0; top: 0; width: 100%; height: 100%; overflow: auto; background-color: rgba(0,0,0,0.4); }
        .modal-content { background-color: #fefefe; margin: 5% auto; padding: 20px; border: 1px solid #888; width: 90%; max-width: 700px; border-radius: 8px; }
        .close { color: #aaa; float: right; font-size: 28px; font-weight: bold; }
        .close:hover, .close:focus { color: #000; text-decoration: none; cursor: pointer; }
        .modal-footer { margin-top: 20px; text-align: right; }
        .modal-footer button { padding: 8px 15px; }

        /* Melhorias no Formulário de Projeto (Novo CSS) */
        .form-row { 
            display: flex; 
            gap: 15px; 
            margin-bottom: 15px;
        }
        .form-group { 
            margin-bottom: 0; 
            flex: 1; 
        }
        .form-group.flex-2 {
            flex: 2; /* Para Título */
        }
        .modal-content label { 
             display: block; 
             font-weight: bold; 
             margin-bottom: 5px; 
        }
        .modal-content input[type="text"], 
        .modal-content input[type="email"], 
        .modal-content input[type="date"],
        .modal-content input[type="number"], 
        .modal-content select, 
        .modal-content textarea { 
            width: 100%; 
            padding: 10px; 
            border: 1px solid #ced4da; 
            border-radius: 4px; 
            box-sizing: border-box; 
            transition: border-color 0.3s;
        }
        .modal-content input:focus, 
        .modal-content select:focus, 
        .modal-content textarea:focus {
            border-color: #28a745; 
            outline: none;
            box-shadow: 0 0 0 0.2rem rgba(40, 167, 69, 0.25);
        }
        .modal-content textarea { 
            resize: vertical; 
        }

        /* Estilos do Modal de Edição de Registro */
        #editModal .modal-content { max-width: 800px; }
        #editModal .form-row { display: flex; gap: 15px; }
        #editModal .form-group { margin-bottom: 15px; flex: 1; }
        #editModal label { display: block; font-weight: bold; margin-bottom: 5px; }
        /* Inputs dentro do modal de edição */
        #editModal input[type="text"], #editModal input[type="email"], #editModal select, #editModal textarea { width: 100%; padding: 8px; border: 1px solid #ccc; border-radius: 4px; box-sizing: border-box; }
        #editModal textarea { resize: none; }
        
        /* Estilos de Impressão (NOVO) */
        #print-area { display: none; padding: 20px; }
        .print-card h3 { color: #28a745; margin-top: 15px; padding-bottom: 5px; border-bottom: 1px dashed #ccc; }
        .print-detail { margin-bottom: 10px; }
        .print-detail strong { display: inline-block; width: 150px; font-weight: bold; }

        /* Media Query para Impressão - Oculta tudo, exceto a área de impressão */
        @media print {
            body > *:not(#print-area) {
                display: none !important;
            }
            #print-area {
                display: block !important;
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                padding: 0;
            }
        }
    </style>
</head>
<body>
    <div class="container" id="main-content"> 
        <h1>Painel Administrativo - Semeando o Futuro</h1>
        <p><a href="index.html">Voltar para a Home</a> | <a href="cadastro.html">Cadastrar Novo Registro</a></p>

        <h2>Métricas Rápidas</h2>
        <div class="metrics">
            <div class="metric-card">
                <h3>Total de Entidades (Registros + Projetos)</h3>
                <p id="total-registros">0</p>
            </div>
            <div class="metric-card">
                <h3>Voluntários Cadastrados</h3>
                <p id="count-voluntarios-metric">0</p>
            </div>
            <div class="metric-card">
                <h3>Doadores Cadastrados</h3>
                <p id="count-doadores-metric">0</p>
            </div>
        </div>
        
        <h2>Gerenciamento de Projetos</h2>
        <button id="btn-abrir-modal-criar-projeto" class="btn-primary">Criar Novo Projeto</button>
        <div class="table-responsive">
            <table id="tabela-projetos">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Título do Projeto</th>
                        <th>Status</th>
                        <th>Prazo</th>
                        <th>Gerente</th>
                        <th>Ações</th>
                    </tr>
                </thead>
                <tbody>
                    <tr id="no-projetos-row" style="display: none;">
                        <td colspan="6" style="text-align: center;">Não há projetos cadastrados.</td>
                    </tr>
                </tbody>
            </table>
        </div>


        <h2>Voluntários Cadastrados</h2>
        <div class="table-responsive">
            <table id="voluntarios-table">
                <thead>
                    <tr>
                        <th>Nome</th>
                        <th>Email</th>
                        <th>Telefone</th>
                        <th>CPF</th> 
                        <th>Áreas de Atuação</th>
                        <th>Ações</th> 
                    </tr>
                </thead>
                <tbody>
                    <tr id="no-voluntarios-row" style="display: none;">
                        <td colspan="6" style="text-align: center;">Não há voluntários cadastrados.</td>
                    </tr>
                </tbody>
            </table>
        </div>


        <h2>Doadores Cadastrados</h2>
        <div class="table-responsive">
            <table id="doadores-table">
                <thead>
                    <tr>
                        <th>Nome</th>
                        <th>Email</th>
                        <th>Valor</th>
                        <th>Frequência</th>
                        <th>Telefone</th>
                        <th>Endereço</th>
                        <th>Ações</th> 
                    </tr>
                </thead>
                <tbody>
                    <tr id="no-doadores-row" style="display: none;">
                        <td colspan="7" style="text-align: center;">Não há doadores cadastrados.</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
    
    
    <div id="modal-projeto" class="modal">
        <div class="modal-content">
            <span class="close" id="btn-fechar-modal">&times;</span>
            <h2 id="modal-titulo">Criar Novo Projeto</h2>
            <form id="form-projeto">
                <input type="hidden" id="projeto-id" name="projeto-id">
                
                <div class="form-row">
                    <div class="form-group flex-2"> <label for="titulo">Título do Projeto:</label>
                        <input type="text" id="titulo" name="titulo" required>
                    </div>
                    <div class="form-group flex-1">
                        <label for="gerente">Gerente Responsável:</label>
                        <select id="gerente" name="gerente" required>
                            <option value="">Selecione um gerente</option>
                            <option value="g1">Ana Silva</option>
                            <option value="g2">Bruno Costa</option>
                            </select>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group flex-1">
                        <label for="data-inicio">Data de Início:</label>
                        <input type="date" id="data-inicio" name="data-inicio" required>
                    </div>
                    <div class="form-group flex-1">
                        <label for="prazo">Prazo Final:</label>
                        <input type="date" id="prazo" name="prazo" required>
                    </div>
                </div>
                
                <div class="form-row">
                    <div class="form-group flex-1">
                        <label for="status">Status:</label>
                        <select id="status" name="status" required>
                            <option value="">Selecione o status</option>
                            <option value="rascunho">Rascunho</option>
                            <option value="novo">Novo</option>
                            <option value="andamento">Em Andamento</option>
                            <option value="concluido">Concluído</option>
                            <option value="cancelado">Cancelado</option>
                        </select>
                    </div>
                    <div class="form-group flex-1">
                        <label for="prioridade">Prioridade:</label>
                        <select id="prioridade" name="prioridade">
                            <option value="baixa">Baixa</option>
                            <option value="media">Média</option>
                            <option value="alta">Alta</option>
                            <option value="urgente">Urgente</option>
                        </select>
                    </div>
                     <div class="form-group flex-1">
                        <label for="orcamento">Orçamento Estimado (R$):</label>
                        <input type="number" id="orcamento" name="orcamento" step="0.01" min="0">
                    </div>
                </div>

                <div class="form-group">
                    <label for="descricao">Descrição Completa:</label>
                    <textarea id="descricao" name="descricao" rows="3"></textarea>
                </div>
                
                <div class="form-group">
                    <label for="membros">Membros da Equipe (Selecione Vários):</label>
                    <select id="membros" name="membros" multiple size="6"> 
                        <option value="m1">Carla Dias (Desenvolvimento)</option>
                        <option value="m2">David Luz (Marketing)</option>
                        <option value="m3">Erica Souza (Logística)</option>
                        <option value="m4">Felipe Rocha (Financeiro)</option>
                        <option value="m5">Guilherme Alves (Comunicação)</option>
                        <option value="m6">Helena Neves (Voluntariado)</option>
                    </select>
                    <small style="color: #6c757d;">Dica: Use Ctrl/Cmd para selecionar múltiplos membros.</small>
                </div>
                
                <div class="modal-footer">
                    <button type="submit" class="btn-primary">Salvar Projeto</button>
                    <button type="button" class="btn-danger" id="btn-cancelar-modal">Cancelar</button>
                </div>
            </form>
        </div>
    </div>
    
    <div id="editModal" class="modal">
        <div class="modal-content">
            <span class="close" id="btn-fechar-edit-modal">&times;</span>
            <h2 id="editModalLabel">Editar Registro</h2>
            
            <form id="edit-form">
                <input type="hidden" id="edit-registro-id" name="id">
                <input type="hidden" id="edit-profile-type" name="profile_type">
                
                <div class="form-row">
                    <div class="form-group col-md-6">
                        <label for="edit-nome">Nome Completo</label>
                        <input type="text" class="form-control" id="edit-nome" name="nome" required>
                    </div>
                    <div class="form-group col-md-6">
                        <label for="edit-email">E-mail</label>
                        <input type="email" class="form-control" id="edit-email" name="email" required>
                    </div>
                </div>
                
                <div class="form-group">
                    <label for="edit-telefone">Telefone</label>
                    <input type="text" class="form-control mask-telefone" id="edit-telefone" name="telefone" required placeholder="(00) 00000-0000" maxlength="15">
                </div>

                <hr>
                
                <div id="edit-campos-voluntario" style="display: none;">
                    <h6>Detalhes do Voluntário</h6>
                    <div class="form-group">
                        <label for="edit-cpf">CPF</label>
                        <input type="text" class="form-control mask-cpf" id="edit-cpf" name="cpf" placeholder="000.000.000-00" maxlength="14">
                    </div>
                    <div class="form-group">
                        <label>Áreas de Atuação (Selecione todas que se aplicam)</label>
                        <div id="edit-area-voluntariado">
                            </div>
                    </div>
                </div>

                <div id="edit-campos-doador" style="display: none;">
                    <h6>Detalhes do Doador</h6>
                    
                    <div class="form-row">
                        <div class="form-group col-md-6">
                            <label for="edit-frequencia_doacao">Frequência</label>
                            <select class="form-control" id="edit-frequencia_doacao" name="frequencia_doacao">
                                <option value="unica">Única</option>
                                <option value="mensal">Mensal</option>
                            </select>
                        </div>
                        
                        <div class="form-group col-md-6">
                            <label for="edit-valor-display">Valor (apenas visualização)</label>
                            <input type="text" class="form-control" id="edit-valor-display" disabled>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="edit-endereco-display">Endereço Completo Salvo</label>
                        <textarea class="form-control" id="edit-endereco-display" rows="2" disabled></textarea>
                        <small class="form-text" style="color: #dc3545;">
                            Para alterar o **endereço** ou o **valor** da doação, o registro completo deve ser excluído e refeito.
                        </small>
                    </div>
                </div>

                <div class="modal-footer">
                    <button type="submit" class="btn-primary">Salvar Alterações</button>
                    <button type="button" class="btn-danger" id="btn-cancelar-edit-modal">Cancelar</button>
                </div>
            </form>
        </div>
    </div>
    
    <div id="print-area">
    </div>


    <script src="js/admin-dashboard.js"></script>
</body>
</html>